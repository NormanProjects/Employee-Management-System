<div class="leave-request-list-container">
  <!-- Header -->
  <header class="page-header">
    <div class="header-content">
      <div class="header-left">
        <button class="back-button" (click)="goBack()">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <line x1="19" y1="12" x2="5" y2="12"></line>
            <polyline points="12 19 5 12 12 5"></polyline>
          </svg>
          Back to Dashboard
        </button>
        <h1>Manage Users</h1>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <main class="page-content">
    <!-- Loading -->
    <div *ngIf="loading" class="loading">
      <div class="spinner"></div>
      <p>Loading users...</p>
    </div>

    <!-- Error -->
    <div *ngIf="error" class="error-message">
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <circle cx="12" cy="12" r="10"></circle>
        <line x1="12" y1="8" x2="12" y2="12"></line>
        <line x1="12" y1="16" x2="12.01" y2="16"></line>
      </svg>
      {{ error }}
    </div>

    <!-- Table -->
    <div *ngIf="!loading && !error" class="table-container">
      <table>
        <thead>
          <tr>
            <th>ID</th>
            <th>Username</th>
            <th>Employee</th>
            <th>Role</th>
            <th>Status</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let user of users">
            <td>{{ user.id }}</td>
            <td>{{ user.username }}</td>
            <td>
              <div *ngIf="user.employee">
                {{ user.employee.firstName }} {{ user.employee.lastName }}
                <div class="email">{{ user.employee.email }}</div>
              </div>
            </td>
            <td>
              <span class="badge">{{ user.employee?.role?.name }}</span>
            </td>
            <td>
              <span class="status-badge" [ngClass]="user.enabled ? 'status-active' : 'status-inactive'">
                {{ user.enabled ? 'Active' : 'Inactive' }}
              </span>
            </td>
            <td class="actions">
              <button 
                class="action-btn" 
                [ngClass]="user.enabled ? 'deactivate-btn' : 'activate-btn'"
                (click)="toggleUserStatus(user.id, user.enabled)">
                {{ user.enabled ? 'Deactivate' : 'Activate' }}
              </button>
              <button 
                class="action-btn delete-btn" 
                (click)="deleteUser(user.id)" 
                *ngIf="isAdmin()">
                Delete
              </button>
            </td>
          </tr>
          <tr *ngIf="users.length === 0">
            <td colspan="6" class="no-data">
              <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                <circle cx="9" cy="7" r="4"></circle>
                <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
              </svg>
              <h3>No users found</h3>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </main>
</div>